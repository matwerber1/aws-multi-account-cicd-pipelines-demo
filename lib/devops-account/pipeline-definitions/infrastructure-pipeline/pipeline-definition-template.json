{
    "pipeline":{
       "name":"$DEVOPS_INFRASTRUCTURE_PIPELINE_NAME",
       "roleArn":"$DEVOPS_PIPELINE_SERVICE_ROLE_ARN",
       "artifactStore":{
          "type":"S3",
          "location":"$DEVOPS_CODFEPIPELINE_BUCKET_NAME",
          "encryptionKey":{
             "id":"$DEVOPS_PIPELINE_KMS_KEY_ARN",
             "type":"KMS"
          }
       },
       "stages":[
          {
             "name":"Source",
             "actions":[
                {
                   "name":"CodeCommit_Source",
                   "actionTypeId":{
                      "category":"Source",
                      "owner":"AWS",
                      "provider":"CodeCommit",
                      "version":"1"
                   },
                   "runOrder":1,
                   "configuration":{
                      "BranchName":"master",
                      "PollForSourceChanges":"false",
                      "RepositoryName":"$DEVOPS_INFRASTRUCTURE_REPO_NAME"
                   },
                   "outputArtifacts":[
                      {
                         "name":"SourceArtifact"
                      }
                   ],
                   "inputArtifacts":[
                      
                   ]
                }
             ]
          },
          {
             "name":"Deploy",
             "actions":[
                {
                   "name":"Deploy_to_Test",
                   "actionTypeId":{
                      "category":"Deploy",
                      "owner":"AWS",
                      "provider":"CloudFormation",
                      "version":"1"
                   },
                   "runOrder":1,
                   "configuration":{
                      "ActionMode":"CREATE_UPDATE",
                      "Capabilities":"CAPABILITY_NAMED_IAM,CAPABILITY_IAM",
                      "RoleArn":"$TEST_CLOUDFORMATION_ROLE",
                      "StackName":"$INFRASTRUCTURE_CLOUDFORMATION_STACK_NAME",
                      "TemplatePath":"SourceArtifact::cloudformation.yaml",
                      "ParameterOverrides": "{\"DevOpsPipelineArtifactBucketName\": \"$DEVOPS_CODFEPIPELINE_BUCKET_NAME\", \"DevOpsPipelineArtifactKmsKeyArn\": \"$DEVOPS_PIPELINE_KMS_KEY_ARN\" }"
                   },
                   "outputArtifacts":[],
                   "inputArtifacts":[
                      {
                         "name":"SourceArtifact"
                      }
                   ],
                   "roleArn":"$TEST_CROSS_ACCOUNT_PIPELINE_DEPLOYMENT_ROLE_ARN"
                },
                {
                   "name":"Approval",
                   "actionTypeId":{
                      "category":"Approval",
                      "owner":"AWS",
                      "provider":"Manual",
                      "version":"1"
                   },
                   "runOrder":2
                },
                {
                    "name":"Deploy_to_Prod",
                    "actionTypeId":{
                       "category":"Deploy",
                       "owner":"AWS",
                       "provider":"CloudFormation",
                       "version":"1"
                    },
                    "runOrder":3,
                    "configuration":{
                       "ActionMode":"CREATE_UPDATE",
                       "Capabilities":"CAPABILITY_NAMED_IAM,CAPABILITY_IAM",
                       "RoleArn":"$PROD_CLOUDFORMATION_ROLE",
                       "StackName":"$INFRASTRUCTURE_CLOUDFORMATION_STACK_NAME",
                       "TemplatePath":"SourceArtifact::cloudformation.yaml"
                    },
                    "outputArtifacts":[],
                    "inputArtifacts":[
                       {
                          "name":"SourceArtifact"
                       }
                    ],
                    "roleArn":"$PROD_CROSS_ACCOUNT_PIPELINE_DEPLOYMENT_ROLE_ARN"
                 }
             ]
          }
       ],
       "version":1
    },
    "tags":[
       {
          "key":"CreatedBy",
          "value":"AWS CLI command"
       }
    ]
 }